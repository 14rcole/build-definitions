# local build script

# to prevent forks from accidentally pushing to redhat-appstudio
# do no allow even authorized users to accidentally use this script to do so. 
REPO_USER=$(git config --get remote.origin.url | cut -d '/' -f 4) 
if [ "$REPO_USER" = "redhat-appstudio" ]; then
    echo "Using redhat-appstudio quay.io user to push results "
    docker build -t quay.io/redhat-appstudio/analyze-devfile:v0.1 .
    docker push quay.io/redhat-appstudio/analyze-devfile:v0.1 
    exit 0 
fi 
if [  -z "$MY_QUAY_USER"]; then
    echo "MY_QUAY_USER is not set, skip this build."
else 
    echo "Using $MY_QUAY_USER to push results "
    docker build -t quay.io/$MY_QUAY_USER/analyze-devfile:v0.1 .
    docker push quay.io/$MY_QUAY_USER/analyze-devfile:v0.1 
    exit 0 
fi 
 

 
 